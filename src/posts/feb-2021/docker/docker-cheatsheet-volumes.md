---
title: â€œDocker cheatsheet 2. Volumes"
date: "2021-02-17"
thumbnail: "../images/dream-job.jpg"
---

![Docker](../images/2021/docker.png)
<br>
#Docker Volumes. Anonymous volumes, Named Volumes and Bind Mounts
<br>

<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Docker cheatsheet 2. Volumes and Bind Mounts</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:27px;line-height:107%;">Named volumes.</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Named volumes, managed by Docker and persisted over the container shutdown, is a folder inside the container where the data that the application needs is stored.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Them can be created on <span style="color:red;">docker run with -v &lt;name folder&gt;:/app/&lt;name folder&gt;</span></span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Example:&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">docker run -p 3000:80 -d -v storedData:/app/storedData &ndash;name &lt;container name&gt;&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">where storedData is the volume created inside the container which will be persisted.</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:29px;line-height:107%;">Bind Mounts</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Bind Mounts is creating a connection between a folder on the machine and another folder inside the container.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">When connecting the root folder of the application with the root folder inside the container, changes in any of those 2 folders will be reflected in the other one.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Ex:&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">docker run -p 3000:80 -d -v storedData:/app:storedData&nbsp;</span><u><span style="font-size:21px;line-height:107%;color:#4472C4;">-v &ldquo;&lt;the entire path to the app root in the machine&gt;:/app:ro&rdquo;</span></u><span style="font-size:21px;line-height:107%;color:#4472C4;">&nbsp; &nbsp;</span><span style="font-size:21px;line-height:107%;color:#7030A0;">-v /app/temp&nbsp;</span><span style="font-size:21px;line-height:107%;color:red;">-rm &ndash;name &lt;container name&gt;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Note we added -rm. So, when the container is removed and recreated, everything will work just fine.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Note <span style="color:red;">:ro&nbsp;</span>in bound mount. This is a read-only flag. So, the app root in the container can&rsquo;t write to root in the machine or another way around, except for the temp file &ndash; we are creating an anonymous volume for that.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:27px;line-height:107%;">Anonymous volume</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">When binding the root folder on the machine to the root folder on the container as in the example here up, the root folder that previously existed in the container is no longer used. It is overwritten by the folder from the machine. Therefore, the node modules may not be installed on the bind mounts. Here an anonymous volume comes in handy because it tells Docker to not overwrite everything inside the container. So, if an anonymous volume is created like: -v /app/node_modules , the node modules will still be there and installed.&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Ex:&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">docker run -p 3000:80 -d -v storedData:/app:storedData -v &ldquo;&lt;the entire path to the app root in the machine&gt;:/app&rdquo;&nbsp;</span><u><span style="font-size:21px;line-height:107%;color:#4472C4;">-v /app/node_modules</span></u><span style="font-size:21px;line-height:107%;color:red;">&nbsp; &ndash;name &lt;container name&gt;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Just a quick note: If you don&apos;t always want to copy and use the full path, you can use these shortcuts:</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">MacOS / Linux: -v $(pwd):/app</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">Windows: -v &quot;%cd%&quot;:/app</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:27px;line-height:107%;">Docker Ignore</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Create a <span style="color:red;">.dockerignore&nbsp;</span>file in the app root on the machine and add the node modules (or anything you need) to it. It will ensure that Docker is not copying those folders/files to the image. Node Modules by example does not have to be copied since it is installed on the container separately.</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:27px;line-height:107%;">Environmental Variables</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Add an environmental variable with ENV command on Dockefile</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Ex:&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">FROM node:&lt;Node Tag eventual&gt;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">WORKDIR /app</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">COPY package.json /app</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">RUN npm install</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">COPY . /app</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:#7030A0;">ENV PORT 80</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">EXPOSE $PORT</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">CMD [&quot;node&quot;, &quot;server.js&quot;]</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;">Set the env when running the container:&nbsp;</span></p>
<p style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;margin-left:0in;line-height:107%;font-size:15px;font-family:"Calibri",sans-serif;'><span style="font-size:21px;line-height:107%;color:red;">docker run -p 3000:80&nbsp;</span><span style="font-size:21px;line-height:107%;color:#7030A0;">&ndash;env PORT=5000&nbsp;</span><span style="font-size:21px;line-height:107%;">or<span style="color:#7030A0;">&nbsp;&ndash;env-file .env&nbsp;</span><span style="color:red;">-d -v storedData:/app:storedData -v &ldquo;&lt;the entire path to the app root in the machine&gt;:/app&rdquo; -v /app/node_modules &nbsp;&ndash;name &lt;container name&gt;</span></span></p>
